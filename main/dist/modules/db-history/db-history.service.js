'use strict';function a184_0x46cb(_0x371737,_0x4aa2f0){const _0xec1fc3=a184_0xec1f();return a184_0x46cb=function(_0x46cb46,_0x5b1e3d){_0x46cb46=_0x46cb46-0xe6;let _0x1946ff=_0xec1fc3[_0x46cb46];if(a184_0x46cb['KpOLiY']===undefined){var _0x4461fc=function(_0xf2c0e3){const _0x4e3278='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x32510b='',_0x337186='';for(let _0x2156b1=0x0,_0x2ce4b5,_0x2573ee,_0x19f38c=0x0;_0x2573ee=_0xf2c0e3['charAt'](_0x19f38c++);~_0x2573ee&&(_0x2ce4b5=_0x2156b1%0x4?_0x2ce4b5*0x40+_0x2573ee:_0x2573ee,_0x2156b1++%0x4)?_0x32510b+=String['fromCharCode'](0xff&_0x2ce4b5>>(-0x2*_0x2156b1&0x6)):0x0){_0x2573ee=_0x4e3278['indexOf'](_0x2573ee);}for(let _0x3dcc22=0x0,_0x31afc5=_0x32510b['length'];_0x3dcc22<_0x31afc5;_0x3dcc22++){_0x337186+='%'+('00'+_0x32510b['charCodeAt'](_0x3dcc22)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x337186);};a184_0x46cb['ooSKJu']=_0x4461fc,_0x371737=arguments,a184_0x46cb['KpOLiY']=!![];}const _0x2ec427=_0xec1fc3[0x0],_0xb32708=_0x46cb46+_0x2ec427,_0x14a5bd=_0x371737[_0xb32708];return!_0x14a5bd?(_0x1946ff=a184_0x46cb['ooSKJu'](_0x1946ff),_0x371737[_0xb32708]=_0x1946ff):_0x1946ff=_0x14a5bd,_0x1946ff;},a184_0x46cb(_0x371737,_0x4aa2f0);}const a184_0x45635e=a184_0x46cb;function a184_0xec1f(){const _0x25ca0a=['nZmYmdbUyvrhD2y','zgvZAwDUoNbHCMfTDhLWzxm','z2v0q29UzG','DgfIBgvFBMfTzq','yxbWBhK','zg9Uzq','thvyreS','uNzJsue','yKDZqKi','zuTctuq','Bwv0ywrHDge','y29TCgXLDgvK','DhLWzw9YBq','CgX4thG','if1fCNjVCIWGuMvHC29UoIa','rgjiAxn0B3j5','rNHosxe','mZm5nJeWwuzWCNzy','rgf0ywjHC2vtDgf0C1f1zxvL','CNLxy0W','uxvLDwuGsw5MBZOGvgfZAYbBu3rHDhmGu1fmxvT0Aw1Lu3rHBxa6ia','BgXSD3y','zxjYB3i','if1szxrYEsbHzNrLCIa','CxvLCNK','B0r2we4','B2jQzwn0','BM93','DgfIBgvFCM93CW','zgvMAw5LuhjVCgvYDhK','mJC5De5LBw1p','D0vuDK8','mte0mdiWohDxCfjADa','yxnZAwDU','ChjVy2vZCW','y3jLyxrLuxvLCNLcDwLSzgvY','uxvLDwuGsw5MBZOGr290ifrHC2TBu3rHDhmGu1fmxq','qg5LC3rQCY9JB21TB24','wu5usuq','wwHvAwK','q29UzMLN','lcb0yxnRvhLWztOG','rhjyv1i','mJuZoduXnuPhv2Pfra','DwXSq0i','DMfSDwu','mJCWmu1rwu9ezG','Bg9Nrgf0ywjHC2vtDgf0CW','mta2BevAz0DM','zMfPBgvK','zNvUy3rPB24','zgf0ywjZzvn0yxrZ','lI4VlI4Vy29TBw9Ul21VCMDHBI1SB2C','rgf0ywjZzvn0yxrZvgfZA1r5Cgu','zgvJB3jHDgu','x19WyxjHBq','zgf0yq','BgvUz3rO','sw5Qzwn0uMvWB3nPDg9YEq','jYbpuKrfuIbcwsb0ywjSzv9YB3DZierfu0m','DgLTzvn0yw1W','x19HD2fPDgvY','DgfZA1r5Cgu','nJu2rxDcqMPg','zgf0ywjZzvn0yxrZuxvLDwviyw5KBgvY','tvLtuuXFrefuqujbu0u','zgjiAxn0B3j5uMvWB3nPDg9YEq','vKrQvM8','y1Hor3u','ALLovxe','D2HLCMu','mte5nZy0mMHxq3rpra','rgjiAxn0B3j5u2vYDMLJzq','zxHLy3v0zq','u0vmrunuihrHyMXLx25HBwuSDgfIBgvFCM93CYbguK9nigLUzM9YBwf0Aw9Ux3nJAgvTys5uqujmrvmGv0HfuKuGvefctevFu0niru1bid0GjW','DgHLBG','C2f2zq','ruzYDKm','yvjoENi','vLb0uNC','yNbQyNm','nJGYnwnOyxjvzW','wNvSu20','r25PCva','C3rYAw5NAwz5','x19LC01VzhvSzq','y3jLyxrLzfrPBwvtDgfTCca8idPJCMvHDgvKvgLTzvn0yw1W','refuqujbu0vFu1rbvfm','zNjVBq','qNnYDgG','CMvTB3zL','sMPVCMW','ywrK','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y'];a184_0xec1f=function(){return _0x25ca0a;};return a184_0xec1f();}(function(_0x2fad80,_0x5d4aa5){const _0x5ed334=a184_0x46cb,_0x129aa5=_0x2fad80();while(!![]){try{const _0x34b295=parseInt(_0x5ed334(0xe7))/0x1*(-parseInt(_0x5ed334(0xe9))/0x2)+-parseInt(_0x5ed334(0x100))/0x3+parseInt(_0x5ed334(0x137))/0x4+-parseInt(_0x5ed334(0x142))/0x5+parseInt(_0x5ed334(0x117))/0x6+-parseInt(_0x5ed334(0x10a))/0x7*(-parseInt(_0x5ed334(0xf8))/0x8)+-parseInt(_0x5ed334(0x135))/0x9*(-parseInt(_0x5ed334(0x128))/0xa);if(_0x34b295===_0x5d4aa5)break;else _0x129aa5['push'](_0x129aa5['shift']());}catch(_0x196aff){_0x129aa5['push'](_0x129aa5['shift']());}}}(a184_0xec1f,0x5cc13));var __decorate=this&&this['__decorate']||function(_0x5b8e89,_0x4f5a84,_0x26169e,_0x39af71){const _0x29df49=a184_0x46cb,_0x13a50f={'Bsrth':function(_0x12c208,_0x5dc887){return _0x12c208<_0x5dc887;},'VDjVo':function(_0x4682a7,_0x560aa8){return _0x4682a7===_0x560aa8;},'ZulSm':function(_0x271c27,_0x187713){return _0x271c27===_0x187713;},'GDXlc':function(_0x45dd36,_0x530bcb){return _0x45dd36-_0x530bcb;},'YIbWS':function(_0x5c284b,_0x4e2b09){return _0x5c284b>=_0x4e2b09;},'wETvO':function(_0x3b480b,_0x134750){return _0x3b480b(_0x134750);}};var _0x53c6af=arguments[_0x29df49(0xf2)],_0x22d99f=_0x13a50f['Bsrth'](_0x53c6af,0x3)?_0x4f5a84:_0x13a50f[_0x29df49(0xfc)](_0x39af71,null)?_0x39af71=Object[_0x29df49(0x116)](_0x4f5a84,_0x26169e):_0x39af71,_0x21c9ca;if(_0x13a50f[_0x29df49(0xfc)](typeof Reflect,_0x29df49(0x131))&&_0x13a50f[_0x29df49(0x10b)](typeof Reflect[_0x29df49(0xef)],'function'))_0x22d99f=Reflect['decorate'](_0x5b8e89,_0x4f5a84,_0x26169e,_0x39af71);else{for(var _0x58ccf7=_0x13a50f['GDXlc'](_0x5b8e89[_0x29df49(0xf2)],0x1);_0x13a50f['YIbWS'](_0x58ccf7,0x0);_0x58ccf7--)if(_0x21c9ca=_0x5b8e89[_0x58ccf7])_0x22d99f=(_0x13a50f[_0x29df49(0x112)](_0x53c6af,0x3)?_0x13a50f[_0x29df49(0x136)](_0x21c9ca,_0x22d99f):_0x53c6af>0x3?_0x21c9ca(_0x4f5a84,_0x26169e,_0x22d99f):_0x21c9ca(_0x4f5a84,_0x26169e))||_0x22d99f;}return _0x53c6af>0x3&&_0x22d99f&&Object[_0x29df49(0x134)](_0x4f5a84,_0x26169e,_0x22d99f),_0x22d99f;},__metadata=this&&this['__metadata']||function(_0x27c6a4,_0x58d7a4){const _0x1464c4=a184_0x46cb,_0x1f8fbb={'VPtRw':function(_0x1e8e0b,_0x5a7aca){return _0x1e8e0b===_0x5a7aca;},'LuXDK':'object','sZhVI':_0x1464c4(0xeb)};if(_0x1f8fbb[_0x1464c4(0x108)](typeof Reflect,_0x1f8fbb[_0x1464c4(0x11d)])&&typeof Reflect['metadata']===_0x1f8fbb['sZhVI'])return Reflect[_0x1464c4(0x121)](_0x27c6a4,_0x58d7a4);},__param=this&&this[a184_0x45635e(0xf0)]||function(_0x18aaf3,_0x3a1a67){const _0x484ec5={'GniqP':function(_0x541b2f,_0x580015,_0x2d5d4d,_0x256c11){return _0x541b2f(_0x580015,_0x2d5d4d,_0x256c11);}};return function(_0x3fd41d,_0x293b0e){const _0x3e5ae2=a184_0x46cb;_0x484ec5[_0x3e5ae2(0x10c)](_0x3a1a67,_0x3fd41d,_0x293b0e,_0x18aaf3);};},__awaiter=this&&this[a184_0x45635e(0xf6)]||function(_0x22a4ec,_0x4f914d,_0xbbaf0f,_0x33d323){const _0x38c7e3={'lzLKm':function(_0x3b0f4f,_0x5cc5ce){return _0x3b0f4f instanceof _0x5cc5ce;},'oDvXN':function(_0x4c4c1b,_0x3be92f){return _0x4c4c1b(_0x3be92f);},'FxNIq':'throw'};function _0x33ca7e(_0x284d18){return _0x38c7e3['lzLKm'](_0x284d18,_0xbbaf0f)?_0x284d18:new _0xbbaf0f(function(_0x72f5b5){_0x72f5b5(_0x284d18);});}return new(_0xbbaf0f||(_0xbbaf0f=Promise))(function(_0x4529e1,_0x37f7a7){const _0x161ddd=a184_0x46cb,_0xb5baf9={'RvcIA':function(_0x458ec5,_0x4fe5e6){const _0x457cde=a184_0x46cb;return _0x38c7e3[_0x457cde(0x130)](_0x458ec5,_0x4fe5e6);}};function _0x44cfa5(_0x5c6ff1){try{_0x38c7e3['oDvXN'](_0x38842e,_0x33d323['next'](_0x5c6ff1));}catch(_0x16364e){_0x38c7e3['oDvXN'](_0x37f7a7,_0x16364e);}}function _0x16a36c(_0x326d28){const _0x989ec=a184_0x46cb;try{_0x38842e(_0x33d323[_0x38c7e3[_0x989ec(0x127)]](_0x326d28));}catch(_0x34356f){_0x38c7e3[_0x989ec(0x130)](_0x37f7a7,_0x34356f);}}function _0x38842e(_0x492b51){const _0x144f4b=a184_0x46cb;_0x492b51[_0x144f4b(0x11c)]?_0x4529e1(_0x492b51[_0x144f4b(0xe6)]):_0xb5baf9[_0x144f4b(0x11e)](_0x33ca7e,_0x492b51[_0x144f4b(0xe6)])[_0x144f4b(0x104)](_0x44cfa5,_0x16a36c);}_0x38842e((_0x33d323=_0x33d323[_0x161ddd(0x11b)](_0x22a4ec,_0x4f914d||[]))['next']());});};Object['defineProperty'](exports,a184_0x45635e(0x10e),{'value':!![]}),exports['DbHistoryService']=exports[a184_0x45635e(0xee)]=void 0x0;const common_1=require(a184_0x45635e(0x13c)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require('typeorm'),db_history_entity_1=require('../../entity/db-history.entity'),task_qull_1=require('../../common/task-qull'),morgan_log_1=require(a184_0x45635e(0xed)),typeorm_3=require(a184_0x45635e(0x123)),config_1=require('../../config/config');var DatabseStatsTaskType;(function(_0x3b9873){const _0x3d4983=a184_0x45635e,_0x5f0e89={'YhUii':_0x3d4983(0x110)};_0x3b9873[_0x3b9873[_0x5f0e89[_0x3d4983(0x13e)]]=0x0]=_0x5f0e89[_0x3d4983(0x13e)];}(DatabseStatsTaskType=exports[a184_0x45635e(0xee)]||(exports[a184_0x45635e(0xee)]={})));const FAILURE_RETRY_INTERVAL=0xbb8;let DbHistoryService=class DbHistoryService{constructor(_0x3b1fe3){const _0xef94f8=a184_0x45635e;this['dbHistoryRepository']=_0x3b1fe3,this[_0xef94f8(0xf9)](),this[_0xef94f8(0x115)]({'timeStamp':Date[_0xef94f8(0x132)]()+'','taskType':DatabseStatsTaskType[_0xef94f8(0x110)]},{'delay':0x0});}[a184_0x45635e(0x115)](_0x36d331,_0x12bca7){const _0x303bff=a184_0x45635e,_0x10ad16={'Jjorl':function(_0x25daca,_0x5afb02,_0x31154a,_0x34f52f,_0x58da58){return _0x25daca(_0x5afb02,_0x31154a,_0x34f52f,_0x58da58);}};return _0x10ad16[_0x303bff(0x114)](__awaiter,this,void 0x0,void 0x0,function*(){const _0x509af=_0x303bff;task_qull_1['DatabaseStatsQueue']['add'](_0x36d331,Object[_0x509af(0x138)](Object[_0x509af(0x138)]({},_0x12bca7),{'backoff':FAILURE_RETRY_INTERVAL,'timeout':0x4e20}));});}['databseStatsQueueHandler'](){const _0x16b53f=a184_0x45635e,_0x5e611b={'ryWcL':function(_0x49753a,_0xde01f2){return _0x49753a+_0xde01f2;},'lllwv':function(_0x1260ec,_0x5c7285){return _0x1260ec*_0x5c7285;},'eKBMD':function(_0x231fec,_0x1c38f2){return _0x231fec*_0x1c38f2;},'bGsBB':function(_0x233170,_0x2034ea){return _0x233170===_0x2034ea;},'Fhxin':function(_0x4f4bb6,_0x4dd77f,_0x515ca1){return _0x4f4bb6(_0x4dd77f,_0x515ca1);},'cXNGu':function(_0x384eae,_0x27fc1d){return _0x384eae(_0x27fc1d);},'plxLx':function(_0x3bae6a,_0x31e502){return _0x3bae6a===_0x31e502;},'EFrvC':_0x16b53f(0x131),'YNTID':_0x16b53f(0x122),'SxdKl':_0x16b53f(0xea)};task_qull_1[_0x16b53f(0x129)]['on'](_0x5e611b[_0x16b53f(0x13d)],(_0xea35cd,_0x2d18c3)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x2f4f25=_0x16b53f;(0x0,morgan_log_1[_0x2f4f25(0xe8)])(!![],_0x2f4f25(0x12b)+_0xea35cd[_0x2f4f25(0xf1)][_0x2f4f25(0xf5)]+_0x2f4f25(0x140)+_0xea35cd[_0x2f4f25(0xf1)]['taskType']+'\x20]\x20Success'),yield this['add']({'timeStamp':_0x5e611b[_0x2f4f25(0x12a)](Date[_0x2f4f25(0x132)](),''),'taskType':DatabseStatsTaskType[_0x2f4f25(0x110)]},{'delay':_0x5e611b[_0x2f4f25(0x12c)](_0x5e611b[_0x2f4f25(0x120)](0x3e8,0x3c),0x5)}),_0xea35cd[_0x2f4f25(0x113)]();})),task_qull_1[_0x16b53f(0x129)]['on'](_0x5e611b['SxdKl'],(_0xf5651e,_0x48b4fa)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x494949=_0x16b53f;(0x0,morgan_log_1[_0x494949(0xe8)])(!![],'Queue\x20Info:\x20Task[Stats\x20SQL][timeStamp:\x20'+_0xf5651e[_0x494949(0xf1)][_0x494949(0xf5)]+_0x494949(0x140)+_0xf5651e[_0x494949(0xf1)][_0x494949(0xf7)]+_0x494949(0x125)+_0x48b4fa),(0x0,morgan_log_1['logDatabaseStats'])(!![],'Queue\x20Info:\x20Task[Stats\x20SQL][timeStamp:\x20'+_0xf5651e[_0x494949(0xf1)][_0x494949(0xf5)]+_0x494949(0x140)+_0xf5651e['data']['taskType']+_0x494949(0x12e)+FAILURE_RETRY_INTERVAL+'ms'),yield this[_0x494949(0x115)]({'timeStamp':Date[_0x494949(0x132)]()+'','taskType':DatabseStatsTaskType[_0x494949(0x110)]},{'delay':FAILURE_RETRY_INTERVAL});})),task_qull_1[_0x16b53f(0x129)][_0x16b53f(0x139)]((_0x444fb4,_0x40c7d6)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x1e8470=_0x16b53f;(0x0,morgan_log_1[_0x1e8470(0xe8)])(![],_0x1e8470(0x13b)+_0x444fb4[_0x1e8470(0xf1)][_0x1e8470(0xf7)]);const {taskType:_0x321a59}=_0x444fb4[_0x1e8470(0xf1)];let _0x299d94=undefined;switch(_0x321a59){case DatabseStatsTaskType[_0x1e8470(0x110)]:_0x299d94=yield this[_0x1e8470(0xec)]();break;default:break;}if(_0x5e611b[_0x1e8470(0x11f)](_0x299d94[_0x1e8470(0x12d)],undefined))_0x5e611b['Fhxin'](_0x40c7d6,null,_0x299d94);else{const {error:_0x1273f3}=_0x299d94;_0x5e611b[_0x1e8470(0xfd)](_0x40c7d6,new Error(_0x5e611b[_0x1e8470(0x124)](typeof _0x1273f3,_0x5e611b[_0x1e8470(0x106)])?JSON[_0x1e8470(0x10d)](_0x1273f3):_0x1273f3));}}));}[a184_0x45635e(0xec)](){const _0x3a75ea=a184_0x45635e,_0x3c49a2={'bpjbs':_0x3a75ea(0xfa),'aRNzr':function(_0x3f69a5,_0x4c4c9c){return _0x3f69a5-_0x4c4c9c;},'jYNUq':function(_0x2fc945,_0x3e1741){return _0x2fc945*_0x3e1741;},'ullCB':function(_0x48b4d0,_0x1a99b7){return _0x48b4d0*_0x1a99b7;},'DrXWR':function(_0x4c3dfd,_0x10e2d4,_0x21abd3,_0x468db4,_0x18effb){return _0x4c3dfd(_0x10e2d4,_0x21abd3,_0x468db4,_0x18effb);}};return _0x3c49a2[_0x3a75ea(0x141)](__awaiter,this,void 0x0,void 0x0,function*(){const _0x511066=_0x3a75ea;try{const _0x2ec457=yield(0x0,typeorm_3['getConnection'])()[_0x511066(0x12f)](_0x511066(0x103)+config_1[_0x511066(0x13f)][_0x511066(0x119)](_0x3c49a2[_0x511066(0x109)])+_0x511066(0xf4)),_0x348403={};for(const _0x144be3 of _0x2ec457){_0x348403[_0x144be3[_0x511066(0x11a)]]=_0x144be3[_0x511066(0x133)];}return yield this[_0x511066(0xfb)][_0x511066(0x105)](new db_history_entity_1[(_0x511066(0x126))](JSON[_0x511066(0x10d)](_0x348403))),yield this[_0x511066(0xfb)][_0x511066(0x13a)]()['delete']()[_0x511066(0x111)](db_history_entity_1['DbHistory'])[_0x511066(0xff)](_0x511066(0x10f),{'createdTimeStamp':_0x3c49a2[_0x511066(0x107)](Date[_0x511066(0x132)](),_0x3c49a2[_0x511066(0xfe)](_0x3c49a2['jYNUq'](_0x3c49a2[_0x511066(0x143)](0x3e8,0x3c),0x3c),0x18)*0x7)})[_0x511066(0x102)](),{'process':!![]};}catch(_0x47de1c){return{'error':_0x47de1c['toString']()};}});}};DbHistoryService=__decorate([(0x0,common_1['Injectable'])(),__param(0x0,(0x0,typeorm_1[a184_0x45635e(0xf3)])(db_history_entity_1[a184_0x45635e(0x126)])),__metadata(a184_0x45635e(0x118),[typeorm_2['Repository']])],DbHistoryService),exports[a184_0x45635e(0x101)]=DbHistoryService;