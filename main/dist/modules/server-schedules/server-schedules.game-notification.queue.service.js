'use strict';const a251_0x5f1605=a251_0x27df;(function(_0x53ff83,_0x136859){const _0x29bc0e=a251_0x27df,_0x38a265=_0x53ff83();while(!![]){try{const _0x4a7896=-parseInt(_0x29bc0e(0x1fc))/0x1*(parseInt(_0x29bc0e(0x1f8))/0x2)+-parseInt(_0x29bc0e(0x1df))/0x3*(parseInt(_0x29bc0e(0x1cc))/0x4)+-parseInt(_0x29bc0e(0x1e4))/0x5+-parseInt(_0x29bc0e(0x1ec))/0x6*(parseInt(_0x29bc0e(0x1fe))/0x7)+parseInt(_0x29bc0e(0x219))/0x8+-parseInt(_0x29bc0e(0x1f5))/0x9+parseInt(_0x29bc0e(0x21d))/0xa;if(_0x4a7896===_0x136859)break;else _0x38a265['push'](_0x38a265['shift']());}catch(_0x5b2cc8){_0x38a265['push'](_0x38a265['shift']());}}}(a251_0x26c3,0x801a7));function a251_0x26c3(){const _0x34055e=['z2v0rgvSyxLLzenVDw50','u0vorf9hqu1fx1jpvvrjtKvFtK9usuzjq0fusu9o','AvLguuu','B0jbEw4','Bg9Nr2fTzu5VDgLMAwnHDgLVBG','yMHbyLq','Bwv0ywrHDge','lcb0yxnRvhLWztOG','vMHStvi','uxvLDwuGAw5MBZOGvgfZAYbBu2vUzcboB3rPzMLJyxrPB25Dw3rPBwvtDgfTCdOG','DgL0Bgu','z2v0q29UzG','DgfZA1r5Cgu','ywrKr2fTzvjVDxrPBMvoB3rPzMLJyxrPB25uB1f1zxvL','vKfJz0e','B2jQzwn0','zgj6v0K','sw5Qzwn0ywjSzq','mZuYmtG1tLr6Efzw','zNvUy3rPB24','BMv4Da','uxvLDwvtzxj2AwnL','y29TCgXLDgvK','otC4ote1EwLRuMvJ','DgHLBG','zxjYB3i','uxvLDwuGsw5MBZOGvgfZAYbYzwnLAxzLzcbBu2vUzcboB3rPzMLJyxrPB25Dia','ENDzvum','DMfSDwu','uLnltMW','z2v0u2vYDMvYq29UzMLN','mte0mda2qLD2zuT3','x19TzxrHzgf0yq','if1fCNjVCIWGCMvHC29UoIa','if0Gzg9Uzq','D0vyt1q','rwnAtw0','x19LC01VzhvSzq','C2vYDMvYu2nOzwr1BgvZr2fTzu5VDgLMAwnHDgLVBLf1zxvLsgfUzgXLCG','EeHgr3m','mtuWotGWngjfsffdDG','lI4VlI4Vy29UzMLNl2nVBMzPzW','rw5HyMXLr2fTzvjVDxrPBMvoB3rPzMLJyxrPB24','ntC3odi2B0nbzvrq','qMvQzfe','uKHfuha','svrIuhu','mK1iuu9JCG','zgvZAwDUoNbHCMfTDhLWzxm','mZqZz3HSsuvl','ywrK','yxnZAwDU','AM9PBG','AfjZEMi','r2fTzvjVDxrPBMvoB3rPzMLJyxrPB24','z1vHvhC','vvbVC0O','weD3CxG','q0zctfa','CgvJzvC','r2fTzvjVDxrPBMvoB3rPzMLJyxrPB25jBNrLCNzHBa','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','C2f2zvf1zxvLsxrLBq','zMfPBgvK','lI4VCxvLDwuVCxvLDwuUC2vYDMLJzq','z3fJAxO','v2L4u0W','BgvUz3rO','r2fTzvjVDxrPBMvoB3rPzMLJyxrPB25rDwv1zq','if1gywLSzwqGzM9Yig1HBNKGDgLTzxmSigrPC2fIBgvKignVBMzPz3mU','uM5MtxC','C2vYDMvYq29UzMLNu2vYDMLJzq','rLfHwLy','zgvJB3jHDgu','BhrKzNu','CgfYC2u','mte5odyYnfPuBwXlzW','ChjVy2nLC3m','C2zhBNm','DxbKyxrLu2vYDMvYq29UzMLN','mJm2ndy5mJbwzLnxDve','u2vYDMvYq29UzMLNu2vYDMLJzq','CxvLDwvtzxj2AwnL','Dg9tDhjPBMC','CxbisvG','BM93','DgHYB3C','CMvTB3zL','x19HD2fPDgvY','zgvMAw5LuhjVCgvYDhK','DgLTzvn0yw1W','wvvrrNG','x19KzwnVCMf0zq','zgf0yq','ChjVy2vZCW','u2vYDMvYu2nOzwr1BgvZr2fTzu5VDgLMAwnHDgLVBLf1zxvLu2vYDMLJzq','lI4VC2vYDMvYlwnVBMzPzY9Zzxj2zxiTy29UzMLNlNnLCNzPy2u','nfjPsLzmDG'];a251_0x26c3=function(){return _0x34055e;};return a251_0x26c3();}var __decorate=this&&this[a251_0x5f1605(0x1c7)]||function(_0x5dff63,_0x2c2537,_0xdeb909,_0x142efd){const _0x2c091b=a251_0x5f1605,_0x5d9efc={'BejdQ':function(_0x100df5,_0x5bf7d0){return _0x100df5<_0x5bf7d0;},'UPosJ':function(_0x52fcbe,_0x2482e1){return _0x52fcbe===_0x2482e1;},'KFjto':'object','gUaTw':'function','VsYGa':function(_0x57b260,_0x19bb2f){return _0x57b260-_0x19bb2f;},'qpHIX':function(_0x56ee51,_0x2a640d){return _0x56ee51>=_0x2a640d;},'wEXOT':function(_0x378f54,_0x18d650){return _0x378f54<_0x18d650;},'ltdfu':function(_0x12d9f8,_0xe2c440){return _0x12d9f8>_0xe2c440;},'epblP':function(_0x2cc49a,_0x2dfac5,_0x2fec1c,_0x484790){return _0x2cc49a(_0x2dfac5,_0x2fec1c,_0x484790);},'RSKNl':function(_0x3fae8d,_0x1f6464,_0x94d66e){return _0x3fae8d(_0x1f6464,_0x94d66e);},'xHFGs':function(_0x14f8a4,_0xab0b23){return _0x14f8a4>_0xab0b23;}};var _0x4434f4=arguments[_0x2c091b(0x210)],_0x1f1fa6=_0x5d9efc[_0x2c091b(0x1f9)](_0x4434f4,0x3)?_0x2c2537:_0x142efd===null?_0x142efd=Object[_0x2c091b(0x20a)](_0x2c2537,_0xdeb909):_0x142efd,_0x51cf92;if(_0x5d9efc[_0x2c091b(0x205)](typeof Reflect,_0x5d9efc['KFjto'])&&_0x5d9efc['UPosJ'](typeof Reflect[_0x2c091b(0x216)],_0x5d9efc[_0x2c091b(0x204)]))_0x1f1fa6=Reflect[_0x2c091b(0x216)](_0x5dff63,_0x2c2537,_0xdeb909,_0x142efd);else{for(var _0x4fee14=_0x5d9efc['VsYGa'](_0x5dff63[_0x2c091b(0x210)],0x1);_0x5d9efc[_0x2c091b(0x221)](_0x4fee14,0x0);_0x4fee14--)if(_0x51cf92=_0x5dff63[_0x4fee14])_0x1f1fa6=(_0x5d9efc[_0x2c091b(0x1f0)](_0x4434f4,0x3)?_0x51cf92(_0x1f1fa6):_0x5d9efc[_0x2c091b(0x217)](_0x4434f4,0x3)?_0x5d9efc['epblP'](_0x51cf92,_0x2c2537,_0xdeb909,_0x1f1fa6):_0x5d9efc[_0x2c091b(0x1ea)](_0x51cf92,_0x2c2537,_0xdeb909))||_0x1f1fa6;}return _0x5d9efc[_0x2c091b(0x1f4)](_0x4434f4,0x3)&&_0x1f1fa6&&Object[_0x2c091b(0x1c4)](_0x2c2537,_0xdeb909,_0x1f1fa6),_0x1f1fa6;},__metadata=this&&this[a251_0x5f1605(0x1ed)]||function(_0xfe8867,_0x1eb89a){const _0x5ac561=a251_0x5f1605,_0x25ebf8={'qlpqz':function(_0x36ba6a,_0x414b6d){return _0x36ba6a===_0x414b6d;},'ITbPu':_0x5ac561(0x1dc),'RnfMw':_0x5ac561(0x1e0)};if(_0x25ebf8['qlpqz'](typeof Reflect,_0x25ebf8[_0x5ac561(0x1fb)])&&typeof Reflect['metadata']===_0x25ebf8[_0x5ac561(0x213)])return Reflect[_0x5ac561(0x1d3)](_0xfe8867,_0x1eb89a);},__awaiter=this&&this[a251_0x5f1605(0x1c3)]||function(_0x112215,_0x70b17a,_0x460e2f,_0x25637d){const _0x2db0cc={'iYFQE':function(_0xe39c29,_0x5944ef){return _0xe39c29(_0x5944ef);},'bhAbT':function(_0xdcd1d9,_0x33e7f0){return _0xdcd1d9 instanceof _0x33e7f0;},'FQaZV':function(_0x6bc102,_0x32ca17){return _0x6bc102(_0x32ca17);},'sfGns':function(_0x43a4bd,_0x172c83){return _0x43a4bd(_0x172c83);}};function _0x18f51c(_0x53c25){const _0x37b6fe=a251_0x27df,_0x47c525={'VAcgA':function(_0x40e2a8,_0x5ebf90){const _0x546801=a251_0x27df;return _0x2db0cc[_0x546801(0x1cf)](_0x40e2a8,_0x5ebf90);}};return _0x2db0cc[_0x37b6fe(0x1d2)](_0x53c25,_0x460e2f)?_0x53c25:new _0x460e2f(function(_0x30d653){const _0x31183f=_0x37b6fe;_0x47c525[_0x31183f(0x1db)](_0x30d653,_0x53c25);});}return new(_0x460e2f||(_0x460e2f=Promise))(function(_0x207812,_0xcf7e7d){const _0x5e29d6=a251_0x27df,_0x194586={'YUQFx':function(_0x40e2e8,_0x164583){const _0x52021f=a251_0x27df;return _0x2db0cc[_0x52021f(0x21b)](_0x40e2e8,_0x164583);}};function _0x1b65ae(_0x5b9a85){const _0x4523aa=a251_0x27df;try{_0x194586[_0x4523aa(0x1c6)](_0x57f3b4,_0x25637d[_0x4523aa(0x1e1)](_0x5b9a85));}catch(_0x5a5ada){_0xcf7e7d(_0x5a5ada);}}function _0x26229b(_0x5a7340){const _0x399832=a251_0x27df;try{_0x2db0cc[_0x399832(0x215)](_0x57f3b4,_0x25637d[_0x399832(0x1c1)](_0x5a7340));}catch(_0xc565db){_0x2db0cc['iYFQE'](_0xcf7e7d,_0xc565db);}}function _0x57f3b4(_0x5756c3){const _0x988a72=a251_0x27df;_0x5756c3['done']?_0x207812(_0x5756c3[_0x988a72(0x1e9)]):_0x18f51c(_0x5756c3['value'])[_0x988a72(0x1e5)](_0x1b65ae,_0x26229b);}_0x2db0cc['sfGns'](_0x57f3b4,(_0x25637d=_0x25637d['apply'](_0x112215,_0x70b17a||[]))[_0x5e29d6(0x1e1)]());});};Object['defineProperty'](exports,a251_0x5f1605(0x1f2),{'value':!![]}),exports['ServerSchedulesGameNotificationQueueService']=void 0x0;const common_1=require('@nestjs/common'),queue_service_1=require(a251_0x5f1605(0x20d)),server_config_service_1=require(a251_0x5f1605(0x1cb)),task_qull_1=require('../../common/task-qull'),morgan_log_1=require('../../common/morgan-log'),config_1=require(a251_0x5f1605(0x1f6));var GameRoutineNotificationTaskType;(function(_0x245891){const _0x295df7=a251_0x5f1605,_0x3750ca={'hRszb':_0x295df7(0x1ce)};_0x245891[_0x245891[_0x3750ca[_0x295df7(0x202)]]=0x0]=_0x3750ca['hRszb'];}(GameRoutineNotificationTaskType||(GameRoutineNotificationTaskType={})));function a251_0x27df(_0x5128ed,_0x179bf8){const _0x26c3c1=a251_0x26c3();return a251_0x27df=function(_0x27dfe1,_0x2c5c32){_0x27dfe1=_0x27dfe1-0x1c1;let _0x111ac6=_0x26c3c1[_0x27dfe1];if(a251_0x27df['XWQLFv']===undefined){var _0xa01a6d=function(_0x85139c){const _0xcae4dc='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x587b70='',_0x2e6f35='';for(let _0x196272=0x0,_0x4dd9bd,_0x2440e5,_0x20adb9=0x0;_0x2440e5=_0x85139c['charAt'](_0x20adb9++);~_0x2440e5&&(_0x4dd9bd=_0x196272%0x4?_0x4dd9bd*0x40+_0x2440e5:_0x2440e5,_0x196272++%0x4)?_0x587b70+=String['fromCharCode'](0xff&_0x4dd9bd>>(-0x2*_0x196272&0x6)):0x0){_0x2440e5=_0xcae4dc['indexOf'](_0x2440e5);}for(let _0x3a340b=0x0,_0x318e93=_0x587b70['length'];_0x3a340b<_0x318e93;_0x3a340b++){_0x2e6f35+='%'+('00'+_0x587b70['charCodeAt'](_0x3a340b)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x2e6f35);};a251_0x27df['QoiGAv']=_0xa01a6d,_0x5128ed=arguments,a251_0x27df['XWQLFv']=!![];}const _0x186524=_0x26c3c1[0x0],_0x1b21bd=_0x27dfe1+_0x186524,_0x193d21=_0x5128ed[_0x1b21bd];return!_0x193d21?(_0x111ac6=a251_0x27df['QoiGAv'](_0x111ac6),_0x5128ed[_0x1b21bd]=_0x111ac6):_0x111ac6=_0x193d21,_0x111ac6;},a251_0x27df(_0x5128ed,_0x179bf8);}const FAILURE_RETRY_INTERVAL=0x1f4;let ServerSchedulesGameNotificationQueueService=class ServerSchedulesGameNotificationQueueService{constructor(_0x5295ab,_0x593ec0){const _0x516002=a251_0x5f1605;this['queueService']=_0x5295ab,this['serverConfigService']=_0x593ec0,this['serverSchedulesGameNotificationQueueHandler'](),this[_0x516002(0x1ff)]({'timeStamp':Date[_0x516002(0x222)]()+'','taskType':GameRoutineNotificationTaskType[_0x516002(0x1ce)]},{'delay':0x0});}[a251_0x5f1605(0x1ff)](_0x53f683,_0xe11c48){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x12aade=a251_0x27df;task_qull_1[_0x12aade(0x211)][_0x12aade(0x1ff)](_0x53f683,Object[_0x12aade(0x200)](Object[_0x12aade(0x200)]({},_0xe11c48),{'attempts':0x5,'backoff':FAILURE_RETRY_INTERVAL,'timeout':0x2710}));});}[a251_0x5f1605(0x1f3)](){const _0x4f5625=a251_0x5f1605,_0x338399={'dbzWI':_0x4f5625(0x209),'EcZMm':function(_0x35f6e5,_0x1be593){return _0x35f6e5+_0x1be593;},'peceW':function(_0x58bb33,_0x2027d6){return _0x58bb33*_0x2027d6;},'gqciz':function(_0x456c0b,_0x1073ee){return _0x456c0b*_0x1073ee;},'oBAyn':function(_0x377e76,_0x311c44){return _0x377e76===_0x311c44;},'CFBLP':_0x4f5625(0x1f7),'RHEPp':'SCUM_STORE_NO','VhlMR':function(_0x4af093,_0x523522){return _0x4af093===_0x523522;},'XGwqx':function(_0x3963be,_0xb54798,_0x5f0966){return _0x3963be(_0xb54798,_0x5f0966);},'zwYUC':function(_0x54b00f,_0x1baf33){return _0x54b00f(_0x1baf33);},'rcKgS':_0x4f5625(0x1e3),'Skerb':_0x4f5625(0x20c)};task_qull_1['GameRoutineNotificationQueue']['on'](_0x338399['rcKgS'],(_0x1df739,_0x1483b3)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xf3f7c5=_0x4f5625;_0x1483b3[_0xf3f7c5(0x21a)]?(0x0,morgan_log_1[_0xf3f7c5(0x1d1)])(!![],_0xf3f7c5(0x1d6)+_0x1df739[_0xf3f7c5(0x1c8)]['timeStamp']+_0xf3f7c5(0x1d4)+_0x1df739[_0xf3f7c5(0x1c8)]['taskType']+_0xf3f7c5(0x1ef)):(0x0,morgan_log_1[_0xf3f7c5(0x1d1)])(![],_0xf3f7c5(0x1d6)+_0x1df739[_0xf3f7c5(0x1c8)][_0xf3f7c5(0x1c5)]+',\x20taskType:\x20'+_0x1df739[_0xf3f7c5(0x1c8)]['taskType']+'\x20]skipped,\x20reason:\x20[null\x20content\x20or\x20config\x20disabled]');let _0x49cb64=yield this[_0xf3f7c5(0x214)][_0xf3f7c5(0x1eb)]({'name':_0x338399[_0xf3f7c5(0x1dd)]});_0x49cb64=JSON[_0xf3f7c5(0x218)](_0x49cb64[_0xf3f7c5(0x1e9)])[_0xf3f7c5(0x1e9)],yield this[_0xf3f7c5(0x1ff)]({'timeStamp':_0x338399[_0xf3f7c5(0x1f1)](Date[_0xf3f7c5(0x222)](),''),'taskType':GameRoutineNotificationTaskType['SEND_GAME_ROUTINE_NOTIFICATION']},{'delay':_0x1483b3[_0xf3f7c5(0x21a)]?_0x338399[_0xf3f7c5(0x208)](_0x338399[_0xf3f7c5(0x20e)](_0x49cb64,0x3e8),0x3c):0x2710}),_0x1df739[_0xf3f7c5(0x1c2)]();})),task_qull_1[_0x4f5625(0x211)]['on'](_0x338399['Skerb'],(_0x5ee438,_0x38adbc)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x2755cd=_0x4f5625,_0x240b90=yield task_qull_1[_0x2755cd(0x211)][_0x2755cd(0x1cd)]();if(_0x338399[_0x2755cd(0x1d0)](_0x240b90,0x0)){(0x0,morgan_log_1[_0x2755cd(0x1d1)])(!![],'Queue\x20info:\x20Task\x20[Send\x20Notification][timeStamp:\x20'+_0x5ee438[_0x2755cd(0x1c8)]['timeStamp']+_0x2755cd(0x1d4)+_0x5ee438['data'][_0x2755cd(0x1d9)]+_0x2755cd(0x212));const _0x14538c=yield this[_0x2755cd(0x214)][_0x2755cd(0x21c)]({'name':_0x338399[_0x2755cd(0x207)],'value':JSON['stringify']({'value':![]})});}else(0x0,morgan_log_1[_0x2755cd(0x1d1)])(!![],_0x2755cd(0x1d6)+_0x5ee438[_0x2755cd(0x1c8)][_0x2755cd(0x1c5)]+_0x2755cd(0x1d4)+_0x5ee438[_0x2755cd(0x1c8)][_0x2755cd(0x1d9)]+_0x2755cd(0x1ee)+_0x38adbc),(0x0,morgan_log_1[_0x2755cd(0x1d1)])(!![],_0x2755cd(0x1d6)+_0x5ee438[_0x2755cd(0x1c8)][_0x2755cd(0x1c5)]+_0x2755cd(0x1d4)+_0x5ee438[_0x2755cd(0x1c8)][_0x2755cd(0x1d9)]+'\x20]Error,\x20Retry\x20after\x20'+FAILURE_RETRY_INTERVAL+'ms');})),task_qull_1[_0x4f5625(0x211)][_0x4f5625(0x1c9)]((_0x2c3f9e,_0x2a0f70)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0xe680da=_0x4f5625;process[_0xe680da(0x1d7)]=config_1['Config'][_0xe680da(0x1d8)](_0x338399[_0xe680da(0x1fa)])+'Backend',(0x0,morgan_log_1[_0xe680da(0x1d1)])(![],_0xe680da(0x1e7)+_0x2c3f9e[_0xe680da(0x1c8)][_0xe680da(0x1d9)]);const {taskType:_0x26c9c9}=_0x2c3f9e[_0xe680da(0x1c8)];let _0x538b28=undefined;switch(_0x26c9c9){case GameRoutineNotificationTaskType[_0xe680da(0x1ce)]:_0x538b28=yield this[_0xe680da(0x1da)]();break;default:break;}if(_0x338399[_0xe680da(0x1d5)](_0x538b28[_0xe680da(0x1e6)],undefined))_0x338399[_0xe680da(0x206)](_0x2a0f70,null,_0x538b28);else{const {error:_0x33e47e}=_0x538b28;_0x338399[_0xe680da(0x1e8)](_0x2a0f70,new Error(_0x33e47e));}}));}['addGameRoutineNotificationToQueue'](){const _0x47b0ed={'WixSL':'EnableGameRoutineNotification'};return __awaiter(this,void 0x0,void 0x0,function*(){const _0xa7bff6=a251_0x27df;try{let _0x3dcfdf=yield this[_0xa7bff6(0x214)][_0xa7bff6(0x1eb)]({'name':_0x47b0ed[_0xa7bff6(0x20f)]});_0x3dcfdf=JSON[_0xa7bff6(0x218)](_0x3dcfdf[_0xa7bff6(0x1e9)])[_0xa7bff6(0x1e9)];let _0x5d26e2=yield this[_0xa7bff6(0x214)][_0xa7bff6(0x1eb)]({'name':_0xa7bff6(0x203)});_0x5d26e2=JSON[_0xa7bff6(0x218)](_0x5d26e2[_0xa7bff6(0x1e9)])[_0xa7bff6(0x1e9)];if(_0x3dcfdf&&_0x5d26e2&&_0x5d26e2['length']){const _0x5a9f48=yield this[_0xa7bff6(0x21f)][_0xa7bff6(0x20b)](_0x5d26e2[_0xa7bff6(0x201)]('\x0a'),'announceMsg');return{'proccess':!![]};}else return{'proccess':![]};}catch(_0x4fc2e9){return{'error':_0x4fc2e9[_0xa7bff6(0x220)]()};}});}};ServerSchedulesGameNotificationQueueService=__decorate([(0x0,common_1[a251_0x5f1605(0x1de)])(),__metadata(a251_0x5f1605(0x1fd),[queue_service_1[a251_0x5f1605(0x1e2)],server_config_service_1[a251_0x5f1605(0x21e)]])],ServerSchedulesGameNotificationQueueService),exports[a251_0x5f1605(0x1ca)]=ServerSchedulesGameNotificationQueueService;