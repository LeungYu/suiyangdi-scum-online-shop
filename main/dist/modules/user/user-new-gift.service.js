'use strict';const a273_0x4693c2=a273_0x41f2;(function(_0x14bfd7,_0x48a591){const _0x20d8aa=a273_0x41f2,_0x44ffd0=_0x14bfd7();while(!![]){try{const _0x139bcf=parseInt(_0x20d8aa(0x155))/0x1+parseInt(_0x20d8aa(0x125))/0x2*(parseInt(_0x20d8aa(0xe0))/0x3)+parseInt(_0x20d8aa(0x130))/0x4+-parseInt(_0x20d8aa(0x133))/0x5*(parseInt(_0x20d8aa(0x131))/0x6)+parseInt(_0x20d8aa(0xf0))/0x7*(parseInt(_0x20d8aa(0x13f))/0x8)+parseInt(_0x20d8aa(0x132))/0x9+parseInt(_0x20d8aa(0x14c))/0xa*(parseInt(_0x20d8aa(0x15b))/0xb);if(_0x139bcf===_0x48a591)break;else _0x44ffd0['push'](_0x44ffd0['shift']());}catch(_0xb39f4){_0x44ffd0['push'](_0x44ffd0['shift']());}}}(a273_0x3afc,0x2fd91));function a273_0x41f2(_0x33ed64,_0xd6cd1d){const _0x3afcd4=a273_0x3afc();return a273_0x41f2=function(_0x41f276,_0x1b555d){_0x41f276=_0x41f276-0xd3;let _0x5573db=_0x3afcd4[_0x41f276];if(a273_0x41f2['isarRt']===undefined){var _0x5a897e=function(_0x4fde24){const _0x30a6c8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x594ba1='',_0x4c22f3='';for(let _0x2b17ad=0x0,_0x317699,_0x38f544,_0xfda239=0x0;_0x38f544=_0x4fde24['charAt'](_0xfda239++);~_0x38f544&&(_0x317699=_0x2b17ad%0x4?_0x317699*0x40+_0x38f544:_0x38f544,_0x2b17ad++%0x4)?_0x594ba1+=String['fromCharCode'](0xff&_0x317699>>(-0x2*_0x2b17ad&0x6)):0x0){_0x38f544=_0x30a6c8['indexOf'](_0x38f544);}for(let _0x16ae04=0x0,_0x21fb80=_0x594ba1['length'];_0x16ae04<_0x21fb80;_0x16ae04++){_0x4c22f3+='%'+('00'+_0x594ba1['charCodeAt'](_0x16ae04)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x4c22f3);};a273_0x41f2['ZujDfT']=_0x5a897e,_0x33ed64=arguments,a273_0x41f2['isarRt']=!![];}const _0x27cd7c=_0x3afcd4[0x0],_0x749de=_0x41f276+_0x27cd7c,_0x3c2dfe=_0x33ed64[_0x749de];return!_0x3c2dfe?(_0x5573db=a273_0x41f2['ZujDfT'](_0x5573db),_0x33ed64[_0x749de]=_0x5573db):_0x5573db=_0x3c2dfe,_0x5573db;},a273_0x41f2(_0x33ed64,_0xd6cd1d);}var __decorate=this&&this[a273_0x4693c2(0x10c)]||function(_0x52a666,_0x2fc6c2,_0x4922a6,_0x2eccfa){const _0x4c1ffe=a273_0x4693c2,_0xfc7fb6={'sRZnZ':function(_0x190535,_0xba7b96){return _0x190535<_0xba7b96;},'Ijjjw':function(_0x5d339a,_0x126fdb){return _0x5d339a===_0x126fdb;},'NFNSY':_0x4c1ffe(0x101),'mnoqJ':function(_0x17dcc2,_0x76e55a){return _0x17dcc2===_0x76e55a;},'MfsyN':'function','eSSbu':function(_0x253274,_0x466692){return _0x253274-_0x466692;},'FKCFg':function(_0x184309,_0x16eb27){return _0x184309<_0x16eb27;},'JmDYK':function(_0x245f6a,_0x105bf0){return _0x245f6a(_0x105bf0);},'neTEi':function(_0x14d879,_0x2e7cfb,_0x367522,_0x38b57c){return _0x14d879(_0x2e7cfb,_0x367522,_0x38b57c);},'XTVvH':function(_0x505573,_0x36afdd,_0x233366){return _0x505573(_0x36afdd,_0x233366);},'vEnYs':function(_0x458213,_0x2c7ecb){return _0x458213>_0x2c7ecb;}};var _0x11c6e2=arguments[_0x4c1ffe(0x102)],_0x2d9b14=_0xfc7fb6['sRZnZ'](_0x11c6e2,0x3)?_0x2fc6c2:_0x2eccfa===null?_0x2eccfa=Object[_0x4c1ffe(0x140)](_0x2fc6c2,_0x4922a6):_0x2eccfa,_0x514077;if(_0xfc7fb6[_0x4c1ffe(0x13e)](typeof Reflect,_0xfc7fb6['NFNSY'])&&_0xfc7fb6[_0x4c1ffe(0xe4)](typeof Reflect[_0x4c1ffe(0x112)],_0xfc7fb6['MfsyN']))_0x2d9b14=Reflect[_0x4c1ffe(0x112)](_0x52a666,_0x2fc6c2,_0x4922a6,_0x2eccfa);else{for(var _0x52ebd9=_0xfc7fb6[_0x4c1ffe(0x10d)](_0x52a666['length'],0x1);_0x52ebd9>=0x0;_0x52ebd9--)if(_0x514077=_0x52a666[_0x52ebd9])_0x2d9b14=(_0xfc7fb6['FKCFg'](_0x11c6e2,0x3)?_0xfc7fb6[_0x4c1ffe(0xee)](_0x514077,_0x2d9b14):_0x11c6e2>0x3?_0xfc7fb6[_0x4c1ffe(0xfe)](_0x514077,_0x2fc6c2,_0x4922a6,_0x2d9b14):_0xfc7fb6[_0x4c1ffe(0x103)](_0x514077,_0x2fc6c2,_0x4922a6))||_0x2d9b14;}return _0xfc7fb6['vEnYs'](_0x11c6e2,0x3)&&_0x2d9b14&&Object[_0x4c1ffe(0x10e)](_0x2fc6c2,_0x4922a6,_0x2d9b14),_0x2d9b14;},__metadata=this&&this[a273_0x4693c2(0xd7)]||function(_0x58db90,_0x5d1760){const _0x2e2a0d=a273_0x4693c2,_0xebe859={'nnmJo':function(_0x8ace76,_0x5b2948){return _0x8ace76===_0x5b2948;},'bCuuZ':_0x2e2a0d(0x101)};if(_0xebe859[_0x2e2a0d(0x138)](typeof Reflect,_0xebe859[_0x2e2a0d(0x136)])&&_0xebe859[_0x2e2a0d(0x138)](typeof Reflect[_0x2e2a0d(0xdc)],_0x2e2a0d(0x147)))return Reflect['metadata'](_0x58db90,_0x5d1760);},__param=this&&this[a273_0x4693c2(0x15d)]||function(_0x1b3458,_0x4948e2){const _0x4947fa={'WCOKk':function(_0x310892,_0x445f5a,_0x8f1179,_0x2ed7c2){return _0x310892(_0x445f5a,_0x8f1179,_0x2ed7c2);}};return function(_0x569ba1,_0x102dd4){_0x4947fa['WCOKk'](_0x4948e2,_0x569ba1,_0x102dd4,_0x1b3458);};},__awaiter=this&&this['__awaiter']||function(_0x39e976,_0x77b96f,_0x441791,_0x4a0409){const _0x3ce06c=a273_0x4693c2,_0x2f0935={'qKTZk':function(_0x2a483d,_0x423ae1){return _0x2a483d(_0x423ae1);},'IJYbo':function(_0x54dd5e,_0x37191a){return _0x54dd5e(_0x37191a);},'XwPlO':_0x3ce06c(0x106)};function _0x9a4244(_0x4c9b70){const _0x584bfb={'mqWKi':function(_0x3b2644,_0x1f31ba){const _0x1f02c7=a273_0x41f2;return _0x2f0935[_0x1f02c7(0x137)](_0x3b2644,_0x1f31ba);}};return _0x4c9b70 instanceof _0x441791?_0x4c9b70:new _0x441791(function(_0x291ed5){const _0x59f8e5=a273_0x41f2;_0x584bfb[_0x59f8e5(0x122)](_0x291ed5,_0x4c9b70);});}return new(_0x441791||(_0x441791=Promise))(function(_0x4c7b72,_0x172e1a){const _0x1fda3d=_0x3ce06c,_0x27e8f0={'rAnuO':function(_0x152305,_0x1918cf){return _0x152305(_0x1918cf);},'ElOHK':_0x2f0935[_0x1fda3d(0xde)],'GpWOG':function(_0xe9510a,_0x5395c2){return _0xe9510a(_0x5395c2);}};function _0x58ca70(_0x4ffd8b){const _0x46c49f=_0x1fda3d;try{_0x137f7b(_0x4a0409[_0x46c49f(0xff)](_0x4ffd8b));}catch(_0x1a91f0){_0x2f0935[_0x46c49f(0x14f)](_0x172e1a,_0x1a91f0);}}function _0x166be1(_0x4c1e3d){const _0x3b6497=_0x1fda3d;try{_0x27e8f0[_0x3b6497(0xd9)](_0x137f7b,_0x4a0409[_0x27e8f0[_0x3b6497(0x111)]](_0x4c1e3d));}catch(_0x4148ab){_0x27e8f0[_0x3b6497(0xd9)](_0x172e1a,_0x4148ab);}}function _0x137f7b(_0x1f22fa){const _0x473ffa=_0x1fda3d;_0x1f22fa['done']?_0x4c7b72(_0x1f22fa[_0x473ffa(0x114)]):_0x27e8f0[_0x473ffa(0xf4)](_0x9a4244,_0x1f22fa['value'])[_0x473ffa(0xe5)](_0x58ca70,_0x166be1);}_0x137f7b((_0x4a0409=_0x4a0409['apply'](_0x39e976,_0x77b96f||[]))[_0x1fda3d(0xff)]());});};Object[a273_0x4693c2(0x10e)](exports,a273_0x4693c2(0x105),{'value':!![]}),exports[a273_0x4693c2(0x110)]=void 0x0;function a273_0x3afc(){const _0x1ae5a9=['C2v0tg9JAW','CgfYC2u','mJbtvMjXuuy','DxnLvhjHBNnHy3rPB24','zxHLy3v0zq','suPzyM8','z2v0vxnLCK5LD0DPzNrmAxn0','DxnLCKLK','revtqW','sgjuDLC','BKTUrwC','mZuYntfdBhPPr2u','lI4VBgv2zwWVBgv2zwWUC2vYDMLJzq','DxnLCK5LD0DPzNqUDxnLCKLKid0GDxnLCK5LD0DPzNrvC2vYlMLK','AwqGpsa6Awq','zNr6vgu','Bgv2zwXtzxj2AwnL','nZy1mtKZr0PeuvHT','DxbKyxrL','x19WyxjHBq','DxnLCKrVBgXHCLnLCNzPy2u','u3vwELa','D2T6t2q','yw5Kv2HLCMu','rev4s1q','D3PWDNC','tKrHEuDPzNrgzwvdB25MAwDZ','DxnLCK5LD0DPzNqUDxnLCK5LD0DPzNrvC2vY','z2v0tg9NAw5vC2vYtgLZDeXPA2u','Dw5LEgnSywLTzwq','DxnLCK5LD0DPzNrszxbVC2L0B3j5','CgfNzvnPEMu','x19TzxrHzgf0yq','lI4VlI4Vy29TBw9Ul2zVCM1HDc1WywDLlxf1zxj5','CKfUDu8','DxnLCK5LD0DPzNqUDxbKyxrLvgLTzvn0yw1Wid49idP0Aw1LC3rHBxbtDgfYDa','zgvSzxrL','Bwv0ywrHDge','qNHmtvG','whDqBe8','vxnLCKrVBgXHCLnLCNzPy2u','mte1nxbKCNrcta','DeH6q0i','BhHTvMm','C29cDe8','Bw5VCuO','DgHLBG','DxbKyxrLvgLTzvn0yw1Wid0GoNvWzgf0zvrPBwvtDgfTCa','rxHWwgS','zNjVBq','vxnLCG','zvzhD04','DxnLCK5LD0DPzNrvC2vY','qg5LC3rQCY9JB21TB24','uMvWB3nPDg9YEq','sM1ewuS','vxnLCLnLCNzPy2u','mJeYog5yBuj5Ea','zK9fsgm','z2v0vxnLCKrVBgXHCG','lI4VlI4Vzw50Axr5l3vZzxiUzw50Axr5','r3bxt0C','y29UzMLNCW','DgLTzxn0yw1Wrw5K','D2ndreK','vxnLCK5LD0DPzNq','z2v0twfUEufUzenVDw50','C2vYDMvYq29UzMLNu2vYDMLJzq','ChvZAa','DxnLCKLKid0GoNvZzxjjza','CMvZzxrvC2vYtMv3r2LMDa','BMvurwK','BMv4Da','yNnAuM4','B2jQzwn0','BgvUz3rO','wfrwDKG','D0XOCgu','x19LC01VzhvSzq','DgHYB3C','tKrHEuDPzNrdB25MAwC','uM55Dfm','DxnLCI1UzxCTz2LMDa','B3jKzxjcEq','u3nYBwC','x19KzwnVCMf0zq','zvntyNu','zgvMAw5LuhjVCgvYDhK','lI4VC2vYDMvYlwnVBMzPzY9Zzxj2zxiTy29UzMLNlNnLCNzPy2u','vxnLCK5LD0DPzNrtzxj2AwnL','rwXpseS','zgvJB3jHDgu','y2XLyw5bBgXvC2vYtMv3r2LMDa','DMfSDwu','DxnLCK5LD0DPzNqUDxbKyxrLvgLTzvn0yw1W','lI4VlI4Vzw50Axr5l3vZzxiTBMv3lwDPzNqUzw50Axr5','y3jLyxrLuxvLCNLcDwLSzgvY','qg5LC3rQCY90ExbLB3jT','CgvZC2LTAxn0AwnFD3jPDgu','Bgv2zwW','C2f2zq','DgLTzxn0yw1Wu3rHCNq','EMPoB1O','CgvZC2LTAxn0AwnFCMvHza','z2v0t25L','yLP6zKm','r0TLy0K','Bxfxs2K','tu1jBxy','AfbWz04','otHPBwXRu0K','wvbJy2G','zgvSzxrLvxnLCK5LD0DPzNq','zM9YBwf0ugfNzvf1zxj5','C2TPCa','ywXS','rxr6A1C','u2ndsgu','DhLWzw9YBq','DxbKyxrLvgLTzvn0yw1W','C2f2zvvZzxjozxDhAwz0','nJCZmtzjsuzVu2u','mtH4CffJt2K','odmXmdmZBMrhEwfu','mtG3nta1AMHAu0rV','uLn6twm','DxnLCLnLCNzPy2u','yKn1DvO','CuTuwMS','BM5TsM8','z2v0vxnLCK5LD0DPzNq','z2v0u2vYDMvYq29UzMLN','AunIDLK','lI91C2vYlwrVBgXHCI5Zzxj2AwnL','zMLUza','swPQANC','mtyWsxjYAgTj','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','z2v0tgv2zwW','CgfNzu51Bq','BM93','zgvZAwDUoNbHCMfTDhLWzxm','DxbKyxrLvgLTzvn0yw1Wid0GoMXVz291DfrPBwvtDgfTCa','DxnLCK5LD0DPzNq','zNvUy3rPB24','B0nmzwm','sw5Qzwn0ywjSzq'];a273_0x3afc=function(){return _0x1ae5a9;};return a273_0x3afc();}const common_1=require(a273_0x4693c2(0xec)),typeorm_1=require(a273_0x4693c2(0x118)),user_new_gift_entity_1=require(a273_0x4693c2(0x116)),typeorm_2=require(a273_0x4693c2(0x12d)),user_entity_1=require(a273_0x4693c2(0xf3)),user_service_1=require('./user.service'),user_dollar_service_1=require(a273_0x4693c2(0x13c)),level_service_1=require(a273_0x4693c2(0x156)),server_config_service_1=require(a273_0x4693c2(0x10f)),format_page_query_1=require(a273_0x4693c2(0xd8));let UserNewGiftService=class UserNewGiftService{constructor(_0x171c58,_0x2005ca,_0xadff5a,_0x518715,_0x4faa6a){const _0x2d3d5a=a273_0x4693c2;this['userNewGiftRepository']=_0x171c58,this[_0x2d3d5a(0x135)]=_0x2005ca,this['userDollarService']=_0xadff5a,this[_0x2d3d5a(0x15a)]=_0x518715,this[_0x2d3d5a(0xfa)]=_0x4faa6a;}[a273_0x4693c2(0x12f)](_0x116b81,_0x5821a7){const _0x83fcb={'fPkKF':function(_0x4c8a20,_0x37661b,_0x170002,_0xe07909,_0x1a22e8){return _0x4c8a20(_0x37661b,_0x170002,_0xe07909,_0x1a22e8);}};return _0x83fcb['fPkKF'](__awaiter,this,void 0x0,void 0x0,function*(){const _0x488923=a273_0x41f2;return yield this[_0x488923(0xd5)][_0x488923(0x11b)](new user_new_gift_entity_1[(_0x488923(0xf8))](_0x116b81,_0x5821a7));});}['updateUserNewGift'](_0xc42390){const _0x2e4d49=a273_0x4693c2,_0x161dc2={'wzpvw':_0x2e4d49(0x119),'GKecI':_0x2e4d49(0x158)};return __awaiter(this,void 0x0,void 0x0,function*(){const _0x44cdbe=_0x2e4d49;let _0x3c52f1=this[_0x44cdbe(0xd5)][_0x44cdbe(0x117)]()['setLock'](_0x44cdbe(0x11e))[_0x44cdbe(0x14a)](_0x161dc2[_0x44cdbe(0x163)])[_0x44cdbe(0x14d)](!![])[_0x44cdbe(0x15c)](user_new_gift_entity_1[_0x44cdbe(0xf8)])['set'](_0xc42390);return _0xc42390['id']&&(_0x3c52f1=_0x3c52f1[_0x44cdbe(0x161)](_0x161dc2[_0x44cdbe(0x121)],{'id':_0xc42390['id']})),yield _0x3c52f1[_0x44cdbe(0x14e)]();});}[a273_0x4693c2(0xd3)](_0x798490,_0x9b01ab){const _0x12a6e4=a273_0x4693c2,_0x3b6134={'SKtlY':_0x12a6e4(0x146),'iCbvY':_0x12a6e4(0x165),'MMImv':_0x12a6e4(0xeb),'eVGwN':_0x12a6e4(0x157),'bsZRn':_0x12a6e4(0xda),'bZzfC':'userNewGift.updateTimeStamp\x20<=\x20:timestampEnd','RnytS':'DESC','nKnEg':function(_0x4f1a7c,_0x19d2e4,_0xf34220,_0x5df794,_0x41db1f){return _0x4f1a7c(_0x19d2e4,_0xf34220,_0x5df794,_0x41db1f);}};return _0x3b6134[_0x12a6e4(0x154)](__awaiter,this,void 0x0,void 0x0,function*(){const _0x49bb83=_0x12a6e4;let _0x15829b=yield this[_0x49bb83(0xd5)][_0x49bb83(0x117)](_0x3b6134['SKtlY']);return _0x15829b=_0x15829b['leftJoinAndMapOne'](_0x3b6134[_0x49bb83(0x13b)],user_entity_1[_0x49bb83(0xe9)],_0x3b6134[_0x49bb83(0x123)],_0x3b6134[_0x49bb83(0xea)]),_0x9b01ab[_0x49bb83(0x151)]&&(_0x15829b=_0x15829b[_0x49bb83(0x161)](_0x49bb83(0xfc),{'userId':_0x9b01ab['userId']})),_0x9b01ab[_0x49bb83(0x11c)]&&_0x9b01ab[_0x49bb83(0xf6)]&&(_0x15829b=_0x15829b[_0x49bb83(0x161)](_0x3b6134[_0x49bb83(0x100)],{'timestampStart':_0x9b01ab[_0x49bb83(0x11c)]}),_0x15829b=_0x15829b[_0x49bb83(0x161)](_0x3b6134[_0x49bb83(0x120)],{'timestampEnd':_0x9b01ab[_0x49bb83(0xf6)]})),yield _0x15829b[_0x49bb83(0x10a)](_0x49bb83(0x115),_0x3b6134[_0x49bb83(0x108)])['skip'](_0x798490[_0x49bb83(0x142)])['take'](_0x798490[_0x49bb83(0xd6)])[_0x49bb83(0xf9)]();});}[a273_0x4693c2(0x150)](_0x11af23,_0x142b77){const _0x4ada3a=a273_0x4693c2,_0x4cb4d8={'bshFO':'user-new-gift','wLhpe':_0x4ada3a(0x158),'LHytj':_0x4ada3a(0xfc),'EtzkW':_0x4ada3a(0x145),'soBtO':_0x4ada3a(0x152),'Ssrmg':function(_0x38b12e,_0x8a14ba,_0x81179e,_0x297a7b,_0x26b93a){return _0x38b12e(_0x8a14ba,_0x81179e,_0x297a7b,_0x26b93a);}};return _0x4cb4d8[_0x4ada3a(0x10b)](__awaiter,this,void 0x0,void 0x0,function*(){const _0x1373e3=_0x4ada3a;let _0xf42f3=yield this[_0x1373e3(0xd5)]['createQueryBuilder'](_0x4cb4d8['bshFO']);return _0x142b77['id']&&(_0xf42f3=_0xf42f3['andWhere'](_0x4cb4d8[_0x1373e3(0x104)],{'id':_0x142b77['id']})),_0x142b77[_0x1373e3(0x151)]&&(_0xf42f3=_0xf42f3['andWhere'](_0x4cb4d8['LHytj'],{'userId':_0x142b77[_0x1373e3(0x151)]})),_0x142b77[_0x1373e3(0x12e)]&&(_0xf42f3=_0xf42f3[_0x1373e3(0x161)](_0x4cb4d8[_0x1373e3(0x12b)],{'updateTimeStamp':_0x142b77[_0x1373e3(0x12e)]})),yield _0xf42f3['orderBy']('updateTimeStamp',_0x4cb4d8[_0x1373e3(0xe3)])[_0x1373e3(0x129)](_0x11af23[_0x1373e3(0x142)])['take'](_0x11af23[_0x1373e3(0xd6)])[_0x1373e3(0xf9)]();});}[a273_0x4693c2(0x139)](_0x351eda){const _0x3be572=a273_0x4693c2,_0x3583e1={'tHzCB':_0x3be572(0x109),'BxLMX':'pessimistic_write','oCLec':'id\x20=\x20:id','lxmVc':_0x3be572(0xfc),'RSzMc':_0x3be572(0xe6)};return __awaiter(this,void 0x0,void 0x0,function*(){const _0x35aaea=_0x3be572;let _0xf18d51=yield this[_0x35aaea(0xd5)][_0x35aaea(0x117)](_0x3583e1[_0x35aaea(0xe1)])[_0x35aaea(0x14a)](_0x3583e1[_0x35aaea(0xdd)])[_0x35aaea(0x14d)](!![]);return _0x351eda&&(_0x351eda['id']||_0x351eda['userId']||_0x351eda[_0x35aaea(0x12e)])?(_0x351eda['id']&&(_0xf18d51=_0xf18d51[_0x35aaea(0x161)](_0x3583e1[_0x35aaea(0x148)],{'id':_0x351eda['id']})),_0x351eda[_0x35aaea(0x151)]&&(_0xf18d51=_0xf18d51[_0x35aaea(0x161)](_0x3583e1[_0x35aaea(0xe2)],{'userId':_0x351eda['userId']})),_0x351eda[_0x35aaea(0x12e)]&&(_0xf18d51=_0xf18d51['andWhere'](_0x3583e1[_0x35aaea(0x134)],{'updateTimeStamp':_0x351eda['updateTimeStamp']})),yield _0xf18d51[_0x35aaea(0x11f)]()):undefined;});}[a273_0x4693c2(0x127)](_0x55e8ef){const _0x25418a=a273_0x4693c2,_0x14b129={'fOEHc':_0x25418a(0x109),'qWCmL':function(_0x1d563b,_0x3f9e52,_0x5020f2,_0x341696,_0x3cb3b8){return _0x1d563b(_0x3f9e52,_0x5020f2,_0x341696,_0x3cb3b8);}};return _0x14b129['qWCmL'](__awaiter,this,void 0x0,void 0x0,function*(){const _0x168bca=_0x25418a;let _0x7fb587=yield this['userNewGiftRepository'][_0x168bca(0x117)](_0x14b129[_0x168bca(0xf1)])[_0x168bca(0xdb)]()[_0x168bca(0xe8)](user_new_gift_entity_1[_0x168bca(0xf8)]);return _0x55e8ef['id']&&(_0x7fb587=_0x7fb587['andWhere'](_0x168bca(0x158),{'id':_0x55e8ef['id']})),_0x55e8ef[_0x168bca(0x151)]&&(_0x7fb587=_0x7fb587[_0x168bca(0x161)](_0x168bca(0xfc),{'userId':_0x55e8ef[_0x168bca(0x151)]})),yield _0x7fb587[_0x168bca(0x14e)]();});}[a273_0x4693c2(0x113)](){const _0x1b22e1={'sDbXt':function(_0x27a11b,_0x2d0efc,_0x24b9ae,_0xb5f250,_0x510177){return _0x27a11b(_0x2d0efc,_0x24b9ae,_0xb5f250,_0x510177);}};return _0x1b22e1['sDbXt'](__awaiter,this,void 0x0,void 0x0,function*(){const _0x7f20a4=a273_0x41f2;return yield this[_0x7f20a4(0xd5)]['clear']();});}[a273_0x4693c2(0xfd)](_0x2473af){const _0x44e15b=a273_0x4693c2,_0x47b2ad={'QIFOU':_0x44e15b(0x107),'YPcch':'NDayGiftFeeConfigs','SuVzP':function(_0x1fe260,_0xdf0bf9){return _0x1fe260!==_0xdf0bf9;},'ExpXk':function(_0x37161c,_0x1353d5){return _0x37161c<_0x1353d5;},'DExKT':function(_0x552301,_0x1df045){return _0x552301+_0x1df045;},'NYMXf':_0x44e15b(0xd4)};return __awaiter(this,void 0x0,void 0x0,function*(){const _0x566ea0=_0x44e15b;yield this[_0x566ea0(0x127)]({'userId':_0x2473af});const _0x12c11d=[],_0x2bc813=Date[_0x566ea0(0x143)](),_0x2e490d=[],_0x361777=yield this[_0x566ea0(0xfa)][_0x566ea0(0x13a)]({'name':_0x47b2ad['QIFOU']}),_0x1815ae=yield this[_0x566ea0(0xfa)][_0x566ea0(0x13a)]({'name':_0x47b2ad[_0x566ea0(0x126)]});let _0x37b3ee=_0x361777&&_0x361777['id']?JSON[_0x566ea0(0x14b)](_0x361777[_0x566ea0(0x114)])[_0x566ea0(0x114)]:[];const _0x1930ae=_0x1815ae&&_0x1815ae['id']?JSON[_0x566ea0(0x14b)](_0x1815ae['value'])[_0x566ea0(0x114)]:[],_0x3c59b3=yield this['userDollarService'][_0x566ea0(0xf2)](_0x2473af),_0xa75c09=yield this[_0x566ea0(0x15a)][_0x566ea0(0x141)]({'level':_0x3c59b3['level']}),_0xfcfe56=_0x1930ae[_0x566ea0(0x13d)](_0xafc865=>_0xafc865[_0x566ea0(0x11a)]===_0xa75c09['level']);_0x47b2ad[_0x566ea0(0x15f)](_0xfcfe56,undefined)&&(_0x37b3ee=_0xfcfe56[_0x566ea0(0xf5)]);for(let _0x1b9062=0x0;_0x47b2ad[_0x566ea0(0xe7)](_0x1b9062,_0x37b3ee['length']);_0x1b9062++){_0x2e490d['push']({'day':_0x47b2ad[_0x566ea0(0x162)](_0x1b9062,0x1),'status':_0x47b2ad['NYMXf']});}return yield this[_0x566ea0(0x12f)](_0x2473af,{'fromTimeStamp':_0x2bc813,'schedules':_0x2e490d});});}['resetAllUserNewGift'](){const _0x394410=a273_0x4693c2,_0x45599b={'ScCHe':function(_0xfacfa7,_0x91a00d){return _0xfacfa7===_0x91a00d;},'wcCDI':function(_0x568b3f,_0xcca6ae){return _0x568b3f(_0xcca6ae);},'OvCul':_0x394410(0x107),'wkzOd':_0x394410(0x164),'ftzTe':function(_0x1c4520,_0x4f3aed){return _0x1c4520<_0x4f3aed;},'zjNoZ':_0x394410(0xd4),'HbTvW':function(_0x456f43,_0x574eea){return _0x456f43+_0x574eea;},'hPpgN':function(_0x3f0ce1,_0x326ff7,_0x53f059,_0x3486f1,_0x4522d3){return _0x3f0ce1(_0x326ff7,_0x53f059,_0x3486f1,_0x4522d3);}};return _0x45599b[_0x394410(0x124)](__awaiter,this,void 0x0,void 0x0,function*(){const _0x143392=_0x394410;yield this['cleanAllUserNewGift']();const _0x31fa71=yield this[_0x143392(0x135)]['getUserList']((0x0,format_page_query_1[_0x143392(0x128)])({'pageNum':0x1,'pageSize':0x1869f}),{}),_0x22bc64=[],_0xd0e1ac=Date[_0x143392(0x143)](),_0x505676=[],_0x3dc07f={},_0x5c5a8b=yield this['serverConfigService'][_0x143392(0x13a)]({'name':_0x45599b['OvCul']}),_0xb81db8=yield this['serverConfigService']['getServerConfig']({'name':_0x45599b[_0x143392(0x160)]}),_0x33f4e6=_0x5c5a8b&&_0x5c5a8b['id']?JSON[_0x143392(0x14b)](_0x5c5a8b[_0x143392(0x114)])[_0x143392(0x114)]:[],_0x244948=_0xb81db8&&_0xb81db8['id']?JSON['parse'](_0xb81db8['value'])[_0x143392(0x114)]:[];for(let _0x28c056=0x0;_0x45599b[_0x143392(0x159)](_0x28c056,_0x33f4e6[_0x143392(0x102)]);_0x28c056++){_0x505676[_0x143392(0xfb)]({'day':_0x28c056+0x1,'status':_0x45599b[_0x143392(0x11d)]});}for(let _0xc1141d=0x0;_0x45599b[_0x143392(0x159)](_0xc1141d,_0x244948['length']);_0xc1141d++){const _0x4565af=[];for(let _0x75c669=0x0;_0x75c669<_0x244948[_0xc1141d]['configs'];_0x75c669++){_0x4565af['push']({'day':_0x45599b[_0x143392(0x153)](_0x75c669,0x1),'status':_0x45599b[_0x143392(0x11d)]}),_0x3dc07f[_0x244948[_0xc1141d]['level']]=_0x4565af;}}for(const _0x52daf5 of _0x31fa71[0x0]){const _0x170cd8=yield this[_0x143392(0x15e)][_0x143392(0xf2)](_0x52daf5['id']),_0xa0e3e=yield this[_0x143392(0x15a)]['getLevel']({'level':_0x170cd8[_0x143392(0x11a)]});_0x22bc64[_0x143392(0xfb)](new Promise((_0x48149e,_0x4b0d46)=>__awaiter(this,void 0x0,void 0x0,function*(){const _0x37741c=_0x143392;try{yield this[_0x37741c(0x12f)](_0x52daf5['id'],{'fromTimeStamp':_0xd0e1ac,'schedules':_0x45599b[_0x37741c(0x12c)](_0x3dc07f[_0xa0e3e['level']],undefined)?_0x505676:_0x3dc07f[_0xa0e3e[_0x37741c(0x11a)]]}),_0x45599b[_0x37741c(0xf7)](_0x48149e,0x1);}catch(_0x3c53e3){_0x4b0d46(0x0);}})));};return Promise[_0x143392(0x12a)](_0x22bc64);});}};UserNewGiftService=__decorate([(0x0,common_1[a273_0x4693c2(0x149)])(),__param(0x0,(0x0,typeorm_1['InjectRepository'])(user_new_gift_entity_1['UserNewGift'])),__metadata(a273_0x4693c2(0x144),[typeorm_2[a273_0x4693c2(0xed)],user_service_1[a273_0x4693c2(0xef)],user_dollar_service_1[a273_0x4693c2(0xdf)],level_service_1['LevelService'],server_config_service_1['ServerConfigService']])],UserNewGiftService),exports['UserNewGiftService']=UserNewGiftService;