'use strict';const a159_0x23587c=a159_0x54ab;(function(_0x2d9352,_0x3fca61){const _0x5b08f0=a159_0x54ab,_0x960e2c=_0x2d9352();while(!![]){try{const _0x19ed0=-parseInt(_0x5b08f0(0x210))/0x1+parseInt(_0x5b08f0(0x1f9))/0x2*(parseInt(_0x5b08f0(0x213))/0x3)+parseInt(_0x5b08f0(0x22d))/0x4+-parseInt(_0x5b08f0(0x214))/0x5*(parseInt(_0x5b08f0(0x211))/0x6)+-parseInt(_0x5b08f0(0x23d))/0x7*(-parseInt(_0x5b08f0(0x247))/0x8)+-parseInt(_0x5b08f0(0x246))/0x9+parseInt(_0x5b08f0(0x226))/0xa;if(_0x19ed0===_0x3fca61)break;else _0x960e2c['push'](_0x960e2c['shift']());}catch(_0x1d21b5){_0x960e2c['push'](_0x960e2c['shift']());}}}(a159_0xd1fb,0xa71c7));function a159_0xd1fb(){const _0xe74bba=['BgvUz3rO','uNDkDe8','u2vZC2LVBG','uMvZCg9UC2vtDgf0DxndB2rL','uevczfG','zgvZAwDUoNbHCMfTDhLWzxm','rfvwDvu','yxbWBhK','DMfSDwu','Bg9NB3v0','y29VA2LLq2zN','uM10Afu','AxntExnbzg1PBG','BMPnAuG','zg9Uzq','DxnLCKrVBgXHCG','zNvUy3rPB24','vxnLCLnLCNzPy2u','qxv0AfnLCNzPy2u','mtC1ohvfs3fAuW','zgvZAwDUoNr5Cgu','ug9ZDa','B2jQzwn0','l2f1DgG','r2v0','CMvZCg9UC2vcDwLSzgvY','lI4VlI4Vy29TBw9Ul21VCMDHBI1SB2C','uMvX','C2n1Bs5ZDg9Yzs0','ANnVBG','ywrTAw5tzxj2AwnL','yxv0AfnLCNzPy2u','lI4VlI4Vy29TBw9Ul21Knq','z2v0q29UzG','Bgv2zwXfEhbPCMvuAw1Lu3rHBxa','u0nvtv9tve9srv9otW','x19LC01VzhvSzq','BM93','y29VA2LL','D0jjBem','q29UDhjVBgXLCG','z2v0vxnLCLbHC3n3B3jK','mte5odGWmvLAC0vrCW','oti1ofLwwfbbta','BMv4Da','mJa1mNnnuxPIAq','mtu5mefdvxnvrG','DgHLBG','lI4VywrTAw4VywrTAw4UC2vYDMLJzq','u2vZC1vZzxi','vgLnAMm','zgvZAwDUoNjLDhvYBNr5Cgu','AxnszwfKt25SEq','rNnSBLG','v0jYDgO','qxv0AenVBNrYB2XSzxi','DxnLCG','Eez4uK4','qM9KEq','DxnLCLnLCNzPy2u','Bgv2zwW','ywrTAw4','uwvlAe0','qwrTAw5tzxj2AwnL','mtGWntK3ntbcD3zqAue','l2XVz291Da','Bwv0ywrHDge','u2vZC2LVBLvZzxi','l2XVz2LU','vKfmsurbveLptL9fuLjpuG','uMvZ','nZG2ntzWEurIDKS','vhnnwuq','vNLqtwi','lI4VlI4VzhrVl2f1DgG','lI4VDxnLCI91C2vYlNnLCNzPy2u','AeLeCeS','x19HD2fPDgvY','tg1Rthm','y2HLy2TwywXPza','vxnLCLbHC3n3B3jKu2vYDMLJzq','C3LZqwrTAw4','tg9NAw5vC2vYqM9KEur0BW','lI4VlI4Vy29UzMLNl2nVBMzPzW','BM9YBwfS','y2HHCMDLrg9SBgfYCW','zLbrrMW','otftqxnAtw0','Bwq1','DujzAum','C0HzrhG','lI4VlI4VzgvJB3jHDg9Yl3vZzxiUzgvJB3jHDg9Y','ChjVDg90ExbL','AKvkEMi','zgvJB3jHDgu','C3rHDhvZ','odKWmdy4nvvTB2nrqq','ntC2mdmYA3jwDMvs','wMfVA2y','lI4VDxnLCI91C2vYlxbHC3n3B3jKlNnLCNzPy2u','Bg9NAw4','DgHYB3C','5A+g56cb6zsz6k+V','tg9NAw5vC2vYrhrV','DxnLCLbHC3n3B3jKu2vYDMLJzq','z2v0t3DUuhjVCgvYDhLezxnJCMLWDg9Y','uM1pChO','lNnPza','zgvMAw5LuhjVCgvYDhK'];a159_0xd1fb=function(){return _0xe74bba;};return a159_0xd1fb();}function a159_0x54ab(_0x4d68f3,_0x4574d0){const _0xd1fbcf=a159_0xd1fb();return a159_0x54ab=function(_0x54ab3e,_0x51af7f){_0x54ab3e=_0x54ab3e-0x1df;let _0x2ff129=_0xd1fbcf[_0x54ab3e];if(a159_0x54ab['YXNNHQ']===undefined){var _0xdfad49=function(_0x57b47e){const _0x2cc792='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x8a9517='',_0x476949='';for(let _0x2eb868=0x0,_0x57877f,_0x3499b2,_0x454744=0x0;_0x3499b2=_0x57b47e['charAt'](_0x454744++);~_0x3499b2&&(_0x57877f=_0x2eb868%0x4?_0x57877f*0x40+_0x3499b2:_0x3499b2,_0x2eb868++%0x4)?_0x8a9517+=String['fromCharCode'](0xff&_0x57877f>>(-0x2*_0x2eb868&0x6)):0x0){_0x3499b2=_0x2cc792['indexOf'](_0x3499b2);}for(let _0x4cf2a2=0x0,_0x5e938f=_0x8a9517['length'];_0x4cf2a2<_0x5e938f;_0x4cf2a2++){_0x476949+='%'+('00'+_0x8a9517['charCodeAt'](_0x4cf2a2)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x476949);};a159_0x54ab['EvQaKt']=_0xdfad49,_0x4d68f3=arguments,a159_0x54ab['YXNNHQ']=!![];}const _0xf88492=_0xd1fbcf[0x0],_0x31df85=_0x54ab3e+_0xf88492,_0x4432ef=_0x4d68f3[_0x31df85];return!_0x4432ef?(_0x2ff129=a159_0x54ab['EvQaKt'](_0x2ff129),_0x4d68f3[_0x31df85]=_0x2ff129):_0x2ff129=_0x4432ef,_0x2ff129;},a159_0x54ab(_0x4d68f3,_0x4574d0);}var __decorate=this&&this['__decorate']||function(_0x511694,_0xb40bd1,_0x412a62,_0x2f6811){const _0x3cece6=a159_0x54ab,_0x37976b={'Zaokf':function(_0x3550cf,_0x443824){return _0x3550cf<_0x443824;},'WBrtj':function(_0x59a967,_0x16efdb){return _0x59a967===_0x16efdb;},'PEBdX':_0x3cece6(0x1fc),'fPQFl':function(_0x27070d,_0x5e46d4){return _0x27070d===_0x5e46d4;},'VyPMb':_0x3cece6(0x1f6),'FOfgc':function(_0x6c6b0c,_0x56480a){return _0x6c6b0c>=_0x56480a;},'QeKhM':function(_0x41d8a9,_0xf0afc9,_0x74a4a9,_0x5f1036){return _0x41d8a9(_0xf0afc9,_0x74a4a9,_0x5f1036);},'wBIlC':function(_0xf4b6e0,_0x117b1e,_0x659fbf){return _0xf4b6e0(_0x117b1e,_0x659fbf);},'TiMjc':function(_0x14bd9c,_0x533cc0){return _0x14bd9c>_0x533cc0;}};var _0x5ca5d9=arguments[_0x3cece6(0x1e6)],_0x6c7ba=_0x37976b[_0x3cece6(0x248)](_0x5ca5d9,0x3)?_0xb40bd1:_0x37976b[_0x3cece6(0x21c)](_0x2f6811,null)?_0x2f6811=Object[_0x3cece6(0x1e2)](_0xb40bd1,_0x412a62):_0x2f6811,_0x22d5aa;if(_0x37976b[_0x3cece6(0x21c)](typeof Reflect,_0x37976b[_0x3cece6(0x1ea)])&&_0x37976b[_0x3cece6(0x23c)](typeof Reflect['decorate'],_0x37976b[_0x3cece6(0x22f)]))_0x6c7ba=Reflect[_0x3cece6(0x244)](_0x511694,_0xb40bd1,_0x412a62,_0x2f6811);else{for(var _0xdcd3a6=_0x511694[_0x3cece6(0x1e6)]-0x1;_0x37976b['FOfgc'](_0xdcd3a6,0x0);_0xdcd3a6--)if(_0x22d5aa=_0x511694[_0xdcd3a6])_0x6c7ba=(_0x37976b[_0x3cece6(0x248)](_0x5ca5d9,0x3)?_0x22d5aa(_0x6c7ba):_0x5ca5d9>0x3?_0x37976b[_0x3cece6(0x224)](_0x22d5aa,_0xb40bd1,_0x412a62,_0x6c7ba):_0x37976b[_0x3cece6(0x20d)](_0x22d5aa,_0xb40bd1,_0x412a62))||_0x6c7ba;}return _0x37976b[_0x3cece6(0x218)](_0x5ca5d9,0x3)&&_0x6c7ba&&Object[_0x3cece6(0x1e5)](_0xb40bd1,_0x412a62,_0x6c7ba),_0x6c7ba;},__metadata=this&&this['__metadata']||function(_0x34399b,_0x4805c6){const _0x4616f5=a159_0x54ab,_0x11673c={'LmkLs':function(_0x112dd4,_0x22178e){return _0x112dd4===_0x22178e;},'xFxRN':_0x4616f5(0x1fc),'jEJzb':_0x4616f5(0x1f6)};if(_0x11673c[_0x4616f5(0x234)](typeof Reflect,_0x11673c[_0x4616f5(0x21f)])&&_0x11673c[_0x4616f5(0x234)](typeof Reflect[_0x4616f5(0x228)],_0x11673c[_0x4616f5(0x243)]))return Reflect['metadata'](_0x34399b,_0x4805c6);},__param=this&&this['__param']||function(_0x1f9a49,_0x5c506f){return function(_0x64dea2,_0x2299fe){_0x5c506f(_0x64dea2,_0x2299fe,_0x1f9a49);};},__awaiter=this&&this[a159_0x23587c(0x233)]||function(_0x2b66ab,_0x5b803d,_0x2ad7e0,_0x533715){const _0xffb327=a159_0x23587c,_0x44516d={'FslnX':function(_0x28f7e1,_0xa2aba5){return _0x28f7e1 instanceof _0xa2aba5;},'TPsqM':_0xffb327(0x24b),'IRDhL':function(_0x38368a,_0x379183){return _0x38368a(_0x379183);}};function _0x31a5e4(_0xf17f95){const _0x40d408=_0xffb327;return _0x44516d[_0x40d408(0x21b)](_0xf17f95,_0x2ad7e0)?_0xf17f95:new _0x2ad7e0(function(_0x28d47b){_0x28d47b(_0xf17f95);});}return new(_0x2ad7e0||(_0x2ad7e0=Promise))(function(_0x499888,_0x4ccaf3){const _0x266d6f=_0xffb327,_0x2310e3={'TsMYD':function(_0x27ef51,_0x34fd4d){return _0x27ef51(_0x34fd4d);},'hIDpK':_0x44516d['TPsqM']};function _0x172a01(_0x5d7e6b){const _0x3f6e30=a159_0x54ab;try{_0x13975d(_0x533715[_0x3f6e30(0x212)](_0x5d7e6b));}catch(_0x47cead){_0x2310e3[_0x3f6e30(0x22e)](_0x4ccaf3,_0x47cead);}}function _0x36e571(_0x3bcddb){const _0x51baeb=a159_0x54ab;try{_0x2310e3[_0x51baeb(0x22e)](_0x13975d,_0x533715[_0x2310e3[_0x51baeb(0x232)]](_0x3bcddb));}catch(_0x23d416){_0x4ccaf3(_0x23d416);}}function _0x13975d(_0x3862ac){const _0x50dfd2=a159_0x54ab;_0x3862ac[_0x50dfd2(0x1f4)]?_0x499888(_0x3862ac[_0x50dfd2(0x1ee)]):_0x31a5e4(_0x3862ac['value'])[_0x50dfd2(0x215)](_0x172a01,_0x36e571);}_0x44516d['IRDhL'](_0x13975d,(_0x533715=_0x533715[_0x266d6f(0x1ed)](_0x2b66ab,_0x5b803d||[]))['next']());});};Object[a159_0x23587c(0x1e5)](exports,a159_0x23587c(0x20a),{'value':!![]}),exports['AuthController']=exports[a159_0x23587c(0x1f0)]=void 0x0;const common_1=require('@nestjs/common'),auth_1=require(a159_0x23587c(0x230)),auth_service_1=require('./auth.service'),user_service_1=require(a159_0x23587c(0x231)),config_1=require(a159_0x23587c(0x239)),session_user_1=require('../../dto/session-user'),user_decorator_1=require(a159_0x23587c(0x241)),response_builder_1=require('../../common/response-builder'),user_password_service_1=require(a159_0x23587c(0x249)),md5_1=require(a159_0x23587c(0x206)),admin_service_1=require(a159_0x23587c(0x216)),morgan_log_1=require(a159_0x23587c(0x200));exports[a159_0x23587c(0x1f0)]={'expires':new Date(0x0),'domain':config_1['Config'][a159_0x23587c(0x207)]('COOKIE_DOMAIN'),'maxAge':0x0,'httpOnly':!![]};let AuthController=class AuthController{constructor(_0x6b8f70,_0x1ab4b5,_0x11999d,_0x1dbdac){const _0x423b43=a159_0x23587c;this[_0x423b43(0x205)]=_0x6b8f70,this[_0x423b43(0x221)]=_0x1ab4b5,this[_0x423b43(0x1e1)]=_0x11999d,this[_0x423b43(0x204)]=_0x1dbdac;}[a159_0x23587c(0x24a)](_0x200401,_0x4c4c02,_0x4445e6,_0x1acc52,_0x588899,_0x2949aa){const _0x476d62=a159_0x23587c,_0x2aec95={'RmthU':_0x476d62(0x223),'qbbeq':_0x476d62(0x237),'Ekbos':'adminReadOnly','avuUt':'user','njMiH':_0x476d62(0x1df),'qTBjc':function(_0x314c1f,_0x5cc62a,_0xeb6bbc,_0x2369e2,_0x4b49e0){return _0x314c1f(_0x5cc62a,_0xeb6bbc,_0x2369e2,_0x4b49e0);}};return _0x2aec95['qTBjc'](__awaiter,this,void 0x0,void 0x0,function*(){const _0x2fb7ca=_0x476d62;if(_0x588899)return _0x1acc52[_0x2fb7ca(0x203)]((0x0,response_builder_1['responseBuilder'])(response_builder_1[_0x2fb7ca(0x1e9)]['OK'],_0x588899));else{const _0x45c0d1=yield this[_0x2fb7ca(0x221)]['getUser']({'phone':_0x4c4c02[_0x2fb7ca(0x21e)]});if(_0x45c0d1){const _0x2ed0ef=_0x45c0d1['id'],_0x4b28d7=(0x0,md5_1[_0x2fb7ca(0x23e)])(_0x4c4c02['password']),_0x2d8f17=yield this[_0x2fb7ca(0x1e1)][_0x2fb7ca(0x20f)](_0x2ed0ef),_0x3ca0c2=_0x2d8f17['password'];if(_0x4b28d7===_0x3ca0c2){const _0x4f2505=yield this[_0x2fb7ca(0x204)]['getAdmin']({'userId':_0x2ed0ef}),_0x166ad7={'userId':_0x2ed0ef,'steamId':_0x45c0d1['steamId'],'permissions':_0x4f2505?_0x4f2505[_0x2fb7ca(0x1f2)]?[_0x2fb7ca(0x237)]:_0x4f2505[_0x2fb7ca(0x21a)]?['adminReadOnly']:[_0x2aec95[_0x2fb7ca(0x1f1)]]:[],'role':_0x4f2505?_0x4f2505[_0x2fb7ca(0x1f2)]?_0x2aec95['qbbeq']:_0x4f2505[_0x2fb7ca(0x21a)]?_0x2aec95['Ekbos']:_0x2aec95[_0x2fb7ca(0x1f1)]:_0x2aec95['avuUt']};_0x2949aa[_0x2fb7ca(0x21e)]=_0x166ad7,_0x1acc52['json']((0x0,response_builder_1['responseBuilder'])(response_builder_1[_0x2fb7ca(0x1e9)]['OK'],_0x166ad7));}else return _0x1acc52['json']((0x0,response_builder_1[_0x2fb7ca(0x1ff)])(response_builder_1[_0x2fb7ca(0x1e9)]['VALIDATION_ERROR'],{},_0x2aec95[_0x2fb7ca(0x1f3)]));}else return _0x1acc52[_0x2fb7ca(0x203)]((0x0,response_builder_1[_0x2fb7ca(0x1ff)])(response_builder_1[_0x2fb7ca(0x1e9)][_0x2fb7ca(0x22b)],{},'用户不存在'));}});}[a159_0x23587c(0x235)](_0x4c3955,_0x1ee246){const _0x44d35b=a159_0x23587c,_0x203404={'RwJtO':function(_0x23949d,_0x15bea2){return _0x23949d>=_0x15bea2;},'DUVuU':function(_0x4a351f,_0x394256){return _0x4a351f===_0x394256;},'RmOpz':_0x44d35b(0x23a),'uBYiC':function(_0x3e5bd8,_0x4229d4){return _0x3e5bd8>=_0x4229d4;}};return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5eaa2e=_0x44d35b;if(_0x1ee246)try{const _0x5a7701=yield this[_0x5eaa2e(0x221)]['getUser'](_0x1ee246);return _0x5a7701&&_0x203404[_0x5eaa2e(0x1e7)](_0x5a7701['id'],0x0)&&_0x203404[_0x5eaa2e(0x1ec)](_0x5a7701[_0x5eaa2e(0x245)],_0x203404[_0x5eaa2e(0x1e3)])?(_0x5a7701[_0x5eaa2e(0x1f5)][_0x5eaa2e(0x222)]=_0x5a7701[_0x5eaa2e(0x1f5)]['levelExpireTimeStamp']===null||_0x203404[_0x5eaa2e(0x1e7)](_0x5a7701['userDollar']['levelExpireTimeStamp'],Date[_0x5eaa2e(0x20b)]())?_0x5a7701['userDollar'][_0x5eaa2e(0x222)]:0x0,_0x5a7701[_0x5eaa2e(0x1f5)][_0x5eaa2e(0x23b)]=_0x203404['DUVuU'](_0x5a7701['userDollar'][_0x5eaa2e(0x208)],null)||_0x203404[_0x5eaa2e(0x23f)](_0x5a7701[_0x5eaa2e(0x1f5)][_0x5eaa2e(0x208)],Date['now']())?_0x5a7701[_0x5eaa2e(0x1f5)][_0x5eaa2e(0x23b)]:0x0,_0x4c3955[_0x5eaa2e(0x203)]((0x0,response_builder_1[_0x5eaa2e(0x1ff)])(response_builder_1[_0x5eaa2e(0x1e9)]['OK'],{'result':!![]}))):_0x4c3955[_0x5eaa2e(0x203)]((0x0,response_builder_1[_0x5eaa2e(0x1ff)])(response_builder_1[_0x5eaa2e(0x1e9)]['OK'],{'result':![]}));}catch(_0x3a9623){return(0x0,morgan_log_1['logBussiness'])(_0x3a9623),_0x4c3955[_0x5eaa2e(0x203)]((0x0,response_builder_1[_0x5eaa2e(0x1ff)])(response_builder_1['ResponseStatusCode']['OK'],{'result':![]}));}else return _0x4c3955[_0x5eaa2e(0x203)]((0x0,response_builder_1[_0x5eaa2e(0x1ff)])(response_builder_1['ResponseStatusCode']['OK'],{'result':![]}));});}[a159_0x23587c(0x1ef)](_0x5018d9,_0x62e3f9){const _0x3f748d=a159_0x23587c,_0xfb2817={'sHYDx':function(_0x456602,_0x5db37f,_0x2d4ef2,_0xce2c55,_0x56fdc8){return _0x456602(_0x5db37f,_0x2d4ef2,_0xce2c55,_0x56fdc8);}};return _0xfb2817[_0x3f748d(0x240)](__awaiter,this,void 0x0,void 0x0,function*(){_0x62e3f9['destroy'](()=>{const _0x88cdeb=a159_0x54ab;_0x5018d9[_0x88cdeb(0x20c)](_0x88cdeb(0x202)+config_1['Config'][_0x88cdeb(0x207)](_0x88cdeb(0x209))+_0x88cdeb(0x1e4),'',exports[_0x88cdeb(0x1f0)]),_0x5018d9[_0x88cdeb(0x203)]((0x0,response_builder_1[_0x88cdeb(0x1ff)])(response_builder_1[_0x88cdeb(0x1e9)]['OK'],{}));});});}};__decorate([(0x0,common_1[a159_0x23587c(0x1fb)])(a159_0x23587c(0x22a)),__param(0x0,(0x0,common_1['Query'])()),__param(0x1,(0x0,common_1[a159_0x23587c(0x220)])()),__param(0x2,(0x0,common_1[a159_0x23587c(0x201)])()),__param(0x3,(0x0,common_1[a159_0x23587c(0x22c)])()),__param(0x4,(0x0,user_decorator_1[a159_0x23587c(0x217)])()),__param(0x5,(0x0,common_1[a159_0x23587c(0x1e8)])()),__metadata(a159_0x23587c(0x1fa),Function),__metadata(a159_0x23587c(0x1eb),[auth_1[a159_0x23587c(0x1e0)],auth_1[a159_0x23587c(0x238)],Object,Object,session_user_1[a159_0x23587c(0x229)],Object]),__metadata('design:returntype',Promise)],AuthController[a159_0x23587c(0x242)],a159_0x23587c(0x24a),null),__decorate([(0x0,common_1['Get'])('/checkValid'),__param(0x0,(0x0,common_1[a159_0x23587c(0x22c)])()),__param(0x1,(0x0,user_decorator_1[a159_0x23587c(0x217)])()),__metadata(a159_0x23587c(0x1fa),Function),__metadata(a159_0x23587c(0x1eb),[Object,session_user_1[a159_0x23587c(0x229)]]),__metadata('design:returntype',Promise)],AuthController[a159_0x23587c(0x242)],'checkValid',null),__decorate([(0x0,common_1[a159_0x23587c(0x1fe)])(a159_0x23587c(0x227)),__param(0x0,(0x0,common_1['Res'])()),__param(0x1,(0x0,common_1['Session'])()),__metadata(a159_0x23587c(0x1fa),Function),__metadata(a159_0x23587c(0x1eb),[Object,Object]),__metadata(a159_0x23587c(0x219),Promise)],AuthController[a159_0x23587c(0x242)],a159_0x23587c(0x1ef),null),AuthController=__decorate([(0x0,common_1[a159_0x23587c(0x20e)])(a159_0x23587c(0x1fd)),__metadata(a159_0x23587c(0x1eb),[auth_service_1[a159_0x23587c(0x1f8)],user_service_1[a159_0x23587c(0x1f7)],user_password_service_1[a159_0x23587c(0x236)],admin_service_1[a159_0x23587c(0x225)]])],AuthController),exports[a159_0x23587c(0x21d)]=AuthController;